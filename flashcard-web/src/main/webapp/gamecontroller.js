/** * Created by jons on 21/09/14. */var GameController= (function () {    var isInitialRound;    var initialRoundMissedCard = [];    /**     * Startar en helt ny omgång     */    var startGame = function(){        var flashcards = Decks.getDeck();        isInitialRound = true;        Deckstate.initFirstRound(flashcards, doNextStep);        Gui.init(currentCardOk, currentCardNok, startGame, startMissedCardRound);        showNextCard();        showUpdatedGraph();    }    /**     * Startar en ny genomgång av en kortleken där några kort missats. Anropas som callback från     * börja-visa-missade-kort-knappen i gränssnittet     */    var startMissedCardRound = function(){        isInitialRound = false;        Deckstate.initOtherRound();        showNextCard();    }    /**     * Markerar ett kort som ok och visar den uppdaterade grafen. Används som callback från ok-knappen     */    var currentCardOk = function(){        Deckstate.currentCardOk();        showUpdatedGraph();    }    /**     * Markerar ett kort som nok och visar den uppdaterade grafen. Används som callback från nok-knappen     */    var currentCardNok = function(){        Deckstate.currentCardNok();        showUpdatedGraph();    }    /**     * Hämtar och visar nästa kort utan koll att sådant finns     */    function showNextCard(){        console.log("showNextCard");        var card = Deckstate.nextCard();        Gui.showCard(card);        showUpdatedGraph();    }    /**     * Callback som anropas när ett kort har markerats ok/Nok     */    function doNextStep(){        console.log("doNextStep");        if(Deckstate.hasMoreCards()){            console.log('hasMoreCards == true');            showNextCard();        } else if(Deckstate.missedCardsExists()){            console.log('hasMoreCards == false');            console.log('Deckstate.missedCardsExists() == true');            // Visar bara 'Du hade bara fel på ...' efter första omgången            if(isInitialRound) {                Gui.showMissedCards(Deckstate.getMissedCardFirstRound(), startMissedCardRound);            } else {                startMissedCardRound();            }        }  else {            console.log('hasMoreCards == false');            console.log('Deckstate.missedCardsExists() == false');            Gui.showFinished(Deckstate.getMissedCardFirstRound());        }    }    function showUpdatedGraph(){        Gui.showUpdatedGraph(            Deckstate.nbrCardsOkFirstRound(),            Deckstate.nbrCardsOkOtherRounds(),            Deckstate.nbrCardsMissed(),            Deckstate.nbrCardsleft());    }    return {        startGame: startGame    };})();