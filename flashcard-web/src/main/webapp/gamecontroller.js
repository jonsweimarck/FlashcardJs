/** * Created by jons on 21/09/14. */var GameController= (function () {    var isInitialRound;    var initialRoundMissedCard = [];    var nbrCardsOkFirstRound;    var nbrCardsOkOtherRounds;    var nbrCardsMissed;    var nbrCardsleft;    var startGame = function(){        var flashcards = Flashcards.getDeck();        isInitialRound = true;        initialRoundMissedCard = [];        nbrCardsOkFirstRound = 0;        nbrCardsOkOtherRounds = 0;        nbrCardsMissed = 0;        nbrCardsleft = flashcards.length;        Gamestate.init(flashcards, whenReadyForNextCard);        Gamearea.init(currentCardOk, currentCardNok, startGame, startMissedCardRound);        Gamearea.showUpdatedGraph(nbrCardsOkFirstRound, nbrCardsOkOtherRounds, nbrCardsMissed,nbrCardsleft);        showNextCard();    }    var currentCardOk = function(){        if(isInitialRound){            nbrCardsOkFirstRound ++;        } else{            nbrCardsOkOtherRounds ++;        }        nbrCardsleft --;        Gamearea.showUpdatedGraph(nbrCardsOkFirstRound, nbrCardsOkOtherRounds, nbrCardsMissed,nbrCardsleft);        Gamestate.currentCardOk();    }    var currentCardNok = function(){        nbrCardsMissed ++;        nbrCardsleft --;        Gamearea.showUpdatedGraph(nbrCardsOkFirstRound, nbrCardsOkOtherRounds, nbrCardsMissed,nbrCardsleft);        Gamestate.currentCardNok();    }    var startMissedCardRound = function(){        isInitialRound = false;        Gamestate.init(Gamestate.getMissedCard(), whenReadyForNextCard);        showNextCard();    }    /**     * Visar nästa kort utan koll att sådan finns     */    function showNextCard(){        console.log("showNextCard");        var card = Gamestate.nextCard();        Gamearea.showCard(card);    }    /**     * Callback som anropas när ngn knapp klickats     */    function whenReadyForNextCard(){        console.log("whenReadyForNextCard");        if(Gamestate.hasMoreCards()){            console.log('hasMoreCards == true');            showNextCard();        } else if(Gamestate.missedCardsExists()){            console.log('hasMoreCards == false');            console.log('Gamestate.missedCardsExists() == true');            var missedCards = Gamestate.getMissedCard();            // Visar bara 'Du hade bara fel på ...' efter första omgången            if(isInitialRound) {                initialRoundMissedCard = missedCards;                Gamearea.showMissedCards(missedCards, startMissedCardRound);            } else {                startMissedCardRound();            }        }  else {            console.log('hasMoreCards == false');            console.log('Gamestate.missedCardsExists() == false');            Gamearea.showFinished(initialRoundMissedCard);        }    }    return {        startGame: startGame    };})();